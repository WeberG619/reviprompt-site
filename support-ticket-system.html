<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ReviPrompt Lab Support System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between py-4">
                <div class="flex items-center">
                    <a href="https://revipromptlab.com" class="text-2xl font-bold text-blue-600">ðŸš€ ReviPrompt Lab</a>
                    <div class="ml-4 text-gray-600">Support Center</div>
                </div>
                <div class="flex items-center space-x-4">
                    <a href="https://kb.revipromptlab.com" class="text-gray-600 hover:text-blue-600">Knowledge Base</a>
                    <a href="https://portal.revipromptlab.com" class="text-gray-600 hover:text-blue-600">Customer Portal</a>
                </div>
            </div>
        </div>
    </header>

    <!-- Support Form -->
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-900 mb-4">Get Help & Support</h1>
            <p class="text-xl text-gray-600">We're here to help you succeed with ReviPrompt Lab</p>
        </div>

        <!-- Quick Help Options -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <div class="bg-white rounded-lg shadow-sm p-6 text-center">
                <div class="bg-blue-100 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-book text-blue-600 text-xl"></i>
                </div>
                <h3 class="font-semibold mb-2">Knowledge Base</h3>
                <p class="text-sm text-gray-600 mb-4">Search our comprehensive help articles</p>
                <a href="https://kb.revipromptlab.com" class="text-blue-600 hover:text-blue-800 text-sm">
                    Browse Articles â†’
                </a>
            </div>

            <div class="bg-white rounded-lg shadow-sm p-6 text-center">
                <div class="bg-green-100 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fab fa-discord text-green-600 text-xl"></i>
                </div>
                <h3 class="font-semibold mb-2">Community</h3>
                <p class="text-sm text-gray-600 mb-4">Join our Discord for peer support</p>
                <a href="https://discord.gg/revipromptlab" class="text-green-600 hover:text-green-800 text-sm">
                    Join Discord â†’
                </a>
            </div>

            <div class="bg-white rounded-lg shadow-sm p-6 text-center">
                <div class="bg-purple-100 w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-video text-purple-600 text-xl"></i>
                </div>
                <h3 class="font-semibold mb-2">Video Tutorials</h3>
                <p class="text-sm text-gray-600 mb-4">Watch step-by-step guides</p>
                <a href="https://portal.revipromptlab.com/videos" class="text-purple-600 hover:text-purple-800 text-sm">
                    Watch Videos â†’
                </a>
            </div>
        </div>

        <!-- Support Ticket Form -->
        <div class="bg-white rounded-lg shadow-sm p-8">
            <h2 class="text-2xl font-bold mb-6">Submit a Support Ticket</h2>
            
            <form id="support-form">
                <!-- Contact Information -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Full Name *</label>
                        <input type="text" id="full-name" required
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Email Address *</label>
                        <input type="email" id="email" required
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>

                <!-- License Information -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">License Key (Optional)</label>
                        <input type="text" id="license-key" placeholder="RPL-X-XXXXXXXX-XXXXXXXX"
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Product Tier</label>
                        <select id="product-tier" 
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="">Select your product tier</option>
                            <option value="free">Free Sampler</option>
                            <option value="foundation">Foundation Pack</option>
                            <option value="professional">Professional Pack</option>
                            <option value="enterprise">Enterprise Pack</option>
                        </select>
                    </div>
                </div>

                <!-- Issue Details -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Issue Category *</label>
                    <select id="issue-category" required
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="">Select issue category</option>
                        <option value="technical">Technical Issue</option>
                        <option value="billing">Billing & Account</option>
                        <option value="download">Download Problems</option>
                        <option value="prompt">Prompt Not Working</option>
                        <option value="dynamo">Dynamo Graph Issues</option>
                        <option value="feature">Feature Request</option>
                        <option value="other">Other</option>
                    </select>
                </div>

                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Priority Level</label>
                    <select id="priority-level"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="low">Low - General question</option>
                        <option value="medium" selected>Medium - Need help but not urgent</option>
                        <option value="high">High - Blocking my work</option>
                        <option value="urgent">Urgent - Critical business impact</option>
                    </select>
                </div>

                <!-- Issue Description -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Subject *</label>
                    <input type="text" id="subject" required placeholder="Brief description of your issue"
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>

                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Detailed Description *</label>
                    <textarea id="description" required rows="6" 
                              placeholder="Please provide as much detail as possible about your issue. Include:
â€¢ What you were trying to do
â€¢ What happened instead
â€¢ Any error messages you received
â€¢ Steps you've already tried"
                              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                </div>

                <!-- System Information -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Revit Version</label>
                        <select id="revit-version"
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="">Select Revit version</option>
                            <option value="2024">Revit 2024</option>
                            <option value="2025">Revit 2025</option>
                            <option value="2026">Revit 2026</option>
                            <option value="2023">Revit 2023</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">AI Tool Used</label>
                        <select id="ai-tool"
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="">Select AI tool</option>
                            <option value="chatgpt">ChatGPT</option>
                            <option value="claude">Claude</option>
                            <option value="copilot">GitHub Copilot</option>
                            <option value="dynamo">Dynamo Graph Only</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                </div>

                <!-- File Attachments -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Attachments (Optional)</label>
                    <div class="border-2 border-dashed border-gray-300 rounded-md p-6 text-center">
                        <input type="file" id="attachments" multiple accept=".jpg,.jpeg,.png,.pdf,.txt,.dyn,.rvt"
                               class="hidden">
                        <i class="fas fa-cloud-upload-alt text-gray-400 text-2xl mb-2"></i>
                        <p class="text-gray-600 mb-2">Drag and drop files here, or click to select</p>
                        <p class="text-sm text-gray-500">Supported: Images, PDFs, Dynamo graphs, Revit files (Max 10MB each)</p>
                        <button type="button" onclick="document.getElementById('attachments').click()"
                                class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition mt-2">
                            Choose Files
                        </button>
                    </div>
                    <div id="file-list" class="mt-3 space-y-2"></div>
                </div>

                <!-- Submit Button -->
                <div class="flex items-center justify-between">
                    <div class="text-sm text-gray-600">
                        <i class="fas fa-shield-alt mr-2"></i>
                        Your information is secure and will only be used to help resolve your issue.
                    </div>
                    <button type="submit" id="submit-btn"
                            class="bg-blue-600 text-white px-8 py-3 rounded-md hover:bg-blue-700 transition font-semibold">
                        Submit Ticket
                    </button>
                </div>
            </form>
        </div>

        <!-- Response Time Information -->
        <div class="mt-8 bg-blue-50 border border-blue-200 rounded-lg p-6">
            <h3 class="font-semibold text-blue-900 mb-3">Expected Response Times</h3>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 text-sm">
                <div class="text-center">
                    <div class="text-red-600 font-semibold">Urgent</div>
                    <div class="text-gray-600">Within 2 hours</div>
                </div>
                <div class="text-center">
                    <div class="text-orange-600 font-semibold">High</div>
                    <div class="text-gray-600">Within 8 hours</div>
                </div>
                <div class="text-center">
                    <div class="text-blue-600 font-semibold">Medium</div>
                    <div class="text-gray-600">Within 24 hours</div>
                </div>
                <div class="text-center">
                    <div class="text-green-600 font-semibold">Low</div>
                    <div class="text-gray-600">Within 48 hours</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Support Ticket System JavaScript
        class SupportTicketSystem {
            constructor() {
                this.apiBase = 'https://api.revipromptlab.com';
                this.maxFileSize = 10 * 1024 * 1024; // 10MB
                this.allowedTypes = ['.jpg', '.jpeg', '.png', '.pdf', '.txt', '.dyn', '.rvt'];
                this.selectedFiles = [];
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.populateUserInfo();
            }

            setupEventListeners() {
                // Form submission
                document.getElementById('support-form').addEventListener('submit', (e) => {
                    this.handleSubmit(e);
                });

                // File upload
                document.getElementById('attachments').addEventListener('change', (e) => {
                    this.handleFileSelection(e);
                });

                // Auto-populate email if user is logged in
                this.autoPopulateFields();
            }

            autoPopulateFields() {
                // Check if user is logged in to customer portal
                const userData = localStorage.getItem('rpl_user');
                if (userData) {
                    const user = JSON.parse(userData);
                    document.getElementById('email').value = user.email;
                    document.getElementById('license-key').value = user.licenseKey;
                    document.getElementById('product-tier').value = user.productTier;
                }
            }

            handleFileSelection(event) {
                const files = Array.from(event.target.files);
                
                files.forEach(file => {
                    if (this.validateFile(file)) {
                        this.selectedFiles.push(file);
                    }
                });

                this.updateFileList();
            }

            validateFile(file) {
                // Check file size
                if (file.size > this.maxFileSize) {
                    alert(`File "${file.name}" is too large. Maximum size is 10MB.`);
                    return false;
                }

                // Check file type
                const extension = '.' + file.name.split('.').pop().toLowerCase();
                if (!this.allowedTypes.includes(extension)) {
                    alert(`File type "${extension}" is not allowed.`);
                    return false;
                }

                return true;
            }

            updateFileList() {
                const fileListDiv = document.getElementById('file-list');
                
                fileListDiv.innerHTML = this.selectedFiles.map((file, index) => `
                    <div class="flex items-center justify-between bg-gray-50 p-3 rounded-md">
                        <div class="flex items-center">
                            <i class="fas fa-file text-gray-400 mr-3"></i>
                            <span class="text-sm">${file.name}</span>
                            <span class="text-xs text-gray-500 ml-2">(${this.formatFileSize(file.size)})</span>
                        </div>
                        <button type="button" onclick="supportSystem.removeFile(${index})" 
                                class="text-red-600 hover:text-red-800">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `).join('');
            }

            removeFile(index) {
                this.selectedFiles.splice(index, 1);
                this.updateFileList();
            }

            formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }

            async handleSubmit(event) {
                event.preventDefault();
                
                const submitBtn = document.getElementById('submit-btn');
                submitBtn.disabled = true;
                submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Submitting...';

                try {
                    const formData = this.collectFormData();
                    const ticketId = await this.submitTicket(formData);
                    
                    this.showSuccessMessage(ticketId);
                    this.resetForm();
                    
                } catch (error) {
                    console.error('Ticket submission error:', error);
                    this.showErrorMessage('Failed to submit ticket. Please try again or email support directly.');
                    
                } finally {
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = 'Submit Ticket';
                }
            }

            collectFormData() {
                return {
                    fullName: document.getElementById('full-name').value,
                    email: document.getElementById('email').value,
                    licenseKey: document.getElementById('license-key').value,
                    productTier: document.getElementById('product-tier').value,
                    issueCategory: document.getElementById('issue-category').value,
                    priority: document.getElementById('priority-level').value,
                    subject: document.getElementById('subject').value,
                    description: document.getElementById('description').value,
                    revitVersion: document.getElementById('revit-version').value,
                    aiTool: document.getElementById('ai-tool').value,
                    attachments: this.selectedFiles,
                    timestamp: new Date().toISOString(),
                    userAgent: navigator.userAgent,
                    url: window.location.href
                };
            }

            async submitTicket(formData) {
                // In production, this would submit to your ticketing system
                // For now, we'll simulate the submission
                
                const ticketId = 'RPL-' + Date.now().toString(36).toUpperCase();
                
                // Simulate API call
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // In production, you would:
                // 1. Send email to support team
                // 2. Store ticket in database
                // 3. Send confirmation email to customer
                // 4. Integrate with ticketing system (Zendesk, Freshdesk, etc.)
                
                console.log('Ticket submitted:', { ticketId, ...formData });
                
                return ticketId;
            }

            showSuccessMessage(ticketId) {
                const successHTML = `
                    <div class="bg-green-50 border border-green-200 rounded-lg p-6 text-center">
                        <i class="fas fa-check-circle text-green-600 text-4xl mb-4"></i>
                        <h3 class="text-xl font-semibold text-green-900 mb-2">Ticket Submitted Successfully!</h3>
                        <p class="text-green-700 mb-4">Your ticket ID is: <strong>${ticketId}</strong></p>
                        <p class="text-sm text-green-600">
                            We've received your support request and will respond according to your priority level.
                            A confirmation email has been sent to your email address.
                        </p>
                    </div>
                `;
                
                document.querySelector('.bg-white.rounded-lg.shadow-sm').innerHTML = successHTML;
            }

            showErrorMessage(message) {
                const errorDiv = document.createElement('div');
                errorDiv.className = 'bg-red-50 border border-red-200 rounded-lg p-4 mb-6';
                errorDiv.innerHTML = `
                    <div class="flex items-center">
                        <i class="fas fa-exclamation-circle text-red-600 mr-3"></i>
                        <div>
                            <p class="text-red-800 font-semibold">Error</p>
                            <p class="text-red-700">${message}</p>
                        </div>
                    </div>
                `;
                
                document.querySelector('.bg-white.rounded-lg.shadow-sm').insertBefore(
                    errorDiv, 
                    document.getElementById('support-form')
                );
                
                setTimeout(() => errorDiv.remove(), 5000);
            }

            resetForm() {
                document.getElementById('support-form').reset();
                this.selectedFiles = [];
                this.updateFileList();
            }

            populateUserInfo() {
                // Pre-populate common system information
                const userAgent = navigator.userAgent;
                
                // Try to detect Revit version from user agent or other sources
                if (userAgent.includes('Revit')) {
                    // Logic to detect Revit version
                }
            }
        }

        // Initialize support system
        const supportSystem = new SupportTicketSystem();
    </script>
</body>
</html>